{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useCallback, useEffect, useState } from 'react';\nimport Image from \"react-native-web/dist/exports/Image\";\nimport PixelRatio from \"react-native-web/dist/exports/PixelRatio\";\nimport { QR_ECL_PERS } from \"../constants\";\nimport { consoleWarn } from \"../helpers\";\nexport default function useQRCodeLogoSize(_ref) {\n  var errorCorrectionLevel = _ref.errorCorrectionLevel,\n    logoHref = _ref.logoHref,\n    logoScale = _ref.logoScale,\n    pieceSize = _ref.pieceSize,\n    qrCodeSize = _ref.qrCodeSize;\n  var _useState = useState({\n      width: 0,\n      height: 0\n    }),\n    _useState2 = _slicedToArray(_useState, 2),\n    transformedLogoSize = _useState2[0],\n    setTransformedLogoSize = _useState2[1];\n  var transformLogoSize = useCallback(function (width, height) {\n    var widthPt = width / PixelRatio.get(),\n      heightPt = height / PixelRatio.get();\n    var sLogo = widthPt * heightPt;\n    var sQR = qrCodeSize ** 2 * pieceSize ** 2;\n    var logoRatio = width / height;\n    var maxS = sQR * QR_ECL_PERS[errorCorrectionLevel];\n    var newWidth;\n    var newHeight;\n    if (sLogo > maxS) {\n      var k = Math.sqrt(maxS / logoRatio);\n      newWidth = Math.floor(k * logoRatio) * logoScale;\n      newHeight = Math.floor(k) * logoScale;\n    } else {\n      newWidth = widthPt * logoScale;\n      newHeight = heightPt * logoScale;\n    }\n    var roundedWidthInPiece = Math.round(newWidth / pieceSize);\n    var roundedHeightInPiece = Math.round(newHeight / pieceSize);\n    if (roundedWidthInPiece === roundedHeightInPiece) {\n      newWidth = pieceSize * (roundedWidthInPiece % 2 === 0 ? roundedWidthInPiece - 1 : roundedWidthInPiece);\n      newHeight = newWidth;\n    } else if (roundedWidthInPiece > roundedHeightInPiece) {\n      newWidth = pieceSize * (roundedWidthInPiece % 2 === 0 ? roundedWidthInPiece - 1 : roundedWidthInPiece);\n      newHeight = pieceSize * (newWidth % pieceSize !== 0 ? roundedHeightInPiece - 1 : roundedHeightInPiece);\n    } else {\n      newHeight = pieceSize * (roundedHeightInPiece % 2 === 0 ? roundedHeightInPiece - 1 : roundedHeightInPiece);\n      newWidth = pieceSize * (newHeight % pieceSize !== 0 ? roundedWidthInPiece - 1 : roundedWidthInPiece);\n    }\n    setTransformedLogoSize({\n      width: newWidth,\n      height: newHeight\n    });\n  }, [errorCorrectionLevel, logoScale, pieceSize, qrCodeSize]);\n  useEffect(function () {\n    if (logoHref) {\n      if (typeof logoHref === 'number') {\n        var _Image$resolveAssetSo = Image.resolveAssetSource(logoHref),\n          width = _Image$resolveAssetSo.width,\n          height = _Image$resolveAssetSo.height;\n        transformLogoSize(width, height);\n      }\n      if (typeof logoHref === 'string') {\n        Image.getSize(logoHref, transformLogoSize, function () {\n          return consoleWarn('Something wrong with logo url: ' + logoHref);\n        });\n      }\n      if (typeof logoHref !== 'string' && typeof logoHref !== 'number' && !Array.isArray(logoHref) && logoHref.uri) {\n        Image.getSize(logoHref.uri, transformLogoSize, function () {\n          return consoleWarn('Something wrong with logo url: ' + logoHref.uri);\n        });\n      }\n    }\n  }, [logoHref, transformLogoSize]);\n  return transformedLogoSize;\n}","map":{"version":3,"names":["useCallback","useEffect","useState","Image","PixelRatio","QR_ECL_PERS","consoleWarn","useQRCodeLogoSize","_ref","errorCorrectionLevel","logoHref","logoScale","pieceSize","qrCodeSize","_useState","width","height","_useState2","_slicedToArray","transformedLogoSize","setTransformedLogoSize","transformLogoSize","widthPt","get","heightPt","sLogo","sQR","logoRatio","maxS","newWidth","newHeight","k","Math","sqrt","floor","roundedWidthInPiece","round","roundedHeightInPiece","_Image$resolveAssetSo","resolveAssetSource","getSize","Array","isArray","uri"],"sources":["useQRCodeLogoSize.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}